<!doctype html><html><head><title>從Bootstrap Typeahead換成Twitter Typeahead // Shiva Huang Talks</title><meta charset=utf-8><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta property="og:title" content="從Bootstrap Typeahead換成Twitter Typeahead"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:locale" content="en"><meta property="og:url" content="https://shivahuang.cocoazen.com/posts/2013-10-22-from-bootstrap-typeahead-to-twitter-typeahead/"><link rel="shortcut icon" href=../../favicon.ico><link href=https://shivahuang.cocoazen.com/webfonts/ptserif/main.css rel=stylesheet type=text/css><link href=https://shivahuang.cocoazen.com/webfonts/source-code-pro/main.css rel=stylesheet type=text/css><link rel=stylesheet href=https://shivahuang.cocoazen.com/css/style.css><meta name=generator content="Hugo 0.117.0"></head><body><div id=container><header id=header><div id=header-outer class=outer><div id=header-inner class=inner><a id=main-nav-toggle class=nav-icon href=javascript:;></a>
<a id=logo class=logo-text href=https://shivahuang.cocoazen.com/>Shiva Huang Talks</a><nav id=main-nav><a class=main-nav-link href=../../tags/>Tags</a></nav><nav id=sub-nav><div id=search-form-wrap></div></nav></div></div></header><section id=main class=outer><article class="article article-type-post" itemscope itemprop=blogPost><div class=article-inner><header class=article-header><h1 class=article-title itemprop=name>從Bootstrap Typeahead換成Twitter Typeahead</h1></header><div class=article-meta><a href=../../posts/2013-10-22-from-bootstrap-typeahead-to-twitter-typeahead/ class=article-date><time datetime=2013-10-22T08:47:00.000+08:00 itemprop=datePublished>2013-10-22</time></a><div class=article-comment-link-wrap><a href=../../posts/2013-10-22-from-bootstrap-typeahead-to-twitter-typeahead/#disqus_thread class=article-comment-link>Comments</a></div></div><div class=article-entry itemprop=articleBody><p>Bootstrap 在 3 之前提供了一個叫做 <a href=http://getbootstrap.com/2.3.2/javascript.html#typeahead>Typeahead</a> 的元件，用途就是在輸入框中根據使用者目前的輸入，先到後台做查詢並且顯示可能的結果。不過這元件在 Bootstrap 3 被<a href=http://getbootstrap.com/getting-started/#migration-notes>拿掉</a>了，官方給的建議是改用 <a href=http://twitter.github.io/typeahead.js/>Twitter Typeahead</a>。</p><h1 id=bootstrap-typeahead>Bootstrap Typeahead</h1><p>Bootstrap Typeahead 要提供候選資料的方式有兩種，一是靜態資料，可以寫在 HTML 中如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-HTML data-lang=HTML><span style=display:flex><span>&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;span3&#34;</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;margin: 0 auto;&#34;</span> <span style=color:#a6e22e>data-provide</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;typeahead&#34;</span> <span style=color:#a6e22e>data-items</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;4&#34;</span> <span style=color:#a6e22e>data-source</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;[&#34;Alabama&#34;,&#34;Alaska&#34;,&#34;Arizona&#34;]&#39;</span>&gt;
</span></span></code></pre></div><p>或者在 JavaScript 中指定：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;.typeahead&#39;</span>).<span style=color:#a6e22e>typeahead</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>source</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;Alabama&#34;</span>,<span style=color:#e6db74>&#34;Alaska&#34;</span>,<span style=color:#e6db74>&#34;Arizona&#34;</span>]
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>另一種方式則是從遠端載入，而遠端載入的時候可以決定要不要加搜尋參數，也就是說連接的資料可以是伺服器上的靜態 json 檔案，也可以是動態回應的搜尋結果。範例如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;.ajax-typeahead&#39;</span>).<span style=color:#a6e22e>typeahead</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>source</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>query</span>, <span style=color:#a6e22e>process</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>$</span>.<span style=color:#a6e22e>ajax</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>url</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/item/search.json&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;get&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>q</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>query</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>dataType</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;json&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>success</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>json</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>typeof</span>(<span style=color:#a6e22e>json</span>) <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;undefined&#39;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>json</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>process</span>(<span style=color:#a6e22e>json</span>.<span style=color:#a6e22e>map</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>item</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>title</span>;
</span></span><span style=display:flex><span>          }));
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>如果想要看 CoffeeScript 版的：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=display:flex><span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;.ajax-typeahead&#39;</span>).<span style=color:#a6e22e>typeahead</span> {
</span></span><span style=display:flex><span>    source: <span style=color:#a6e22e>(query, process) -&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>$</span>.<span style=color:#a6e22e>ajax</span> {
</span></span><span style=display:flex><span>            url: <span style=color:#e6db74>&#39;/item/search.json&#39;</span>,
</span></span><span style=display:flex><span>            type: <span style=color:#e6db74>&#39;get&#39;</span>,
</span></span><span style=display:flex><span>            data: {q: <span style=color:#a6e22e>query</span>},
</span></span><span style=display:flex><span>            dataType: <span style=color:#e6db74>&#39;json&#39;</span>,
</span></span><span style=display:flex><span>            success: <span style=color:#a6e22e>(json) -&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>json</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;undefined&#39;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>json</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>then</span> <span style=color:#66d9ef>false</span> <span style=color:#66d9ef>else</span> <span style=color:#a6e22e>process</span>(<span style=color:#a6e22e>json</span>.<span style=color:#a6e22e>map</span> <span style=color:#a6e22e>(item) -&gt;</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>title</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>老實說這用法有點複雜&mldr;</p><h1 id=twitter-typeahead>Twitter Typeahead</h1><p>要換成 Twitter Typeahead 其實相當簡單，首先在網頁上匯入 <code>typeahead.js</code>，接著一樣用 <code>$('.ajax-typeahead').typeahead()</code> 的方法呼叫，只是指定候選資料的方式不太一樣。Twitter Typeahead 指定候選資料的參數有三種：</p><ol><li><code>local</code>：直接寫在網頁中，是個字串陣列</li><li><code>prefetch</code>：遠端 Server 上的 JSON 檔</li><li><code>remote</code>：Server query，預設的 query string token 是 <code>%QUERY</code>，可以用 <code>remote</code> 自己的 <code>wildcard</code> 這個 option 指定</li></ol><p>這幾個參數的特點是可以混著用。你可以把最基本的幾個選項直接寫在 <code>local</code> 中，剩下靜態的資料用 <code>prefetch</code> 抓取，最後真的查不到的資料再到 <code>remote</code> 去查。範例（修改自<a href=https://github.com/twitter/typeahead.js/#jquerytypeaheaddatasets>Twitter 範例</a>）如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;input.typeahead-devs&#39;</span>).<span style=color:#a6e22e>typeahead</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;accounts&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>local</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;timtrueman&#39;</span>, <span style=color:#e6db74>&#39;JakeHarding&#39;</span>, <span style=color:#e6db74>&#39;vskarich&#39;</span>],
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>prefetch</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;https://twitter.com/network.json&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>remote</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;https://twitter.com/accounts?q=%QUERY&#39;</span>
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>另外，Twitter Typeahead 可以提供多個資料集（dataset），只要將每個 dataset 放在陣列中傳入即可，<a href=http://twitter.github.io/typeahead.js/examples/>官方範例</a>寫得相當清楚：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;.example-sports .typeahead&#39;</span>).<span style=color:#a6e22e>typeahead</span>([
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;nba-teams&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>prefetch</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;../data/nba.json&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>header</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&lt;h3 class=&#34;league-name&#34;&gt;NBA Teams&lt;/h3&gt;&#39;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;nhl-teams&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>prefetch</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;../data/nhl.json&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>header</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&lt;h3 class=&#34;league-name&#34;&gt;NHL Teams&lt;/h3&gt;&#39;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>]);
</span></span></code></pre></div><p>Twitter Typeahead 還有些進階的應用，例如可以設計候選清單每個 cell 的樣式，除了直接將候選詞用 JSON 陣列回傳之外，也可以回傳 Twitter Typeahead 自己定義的 JSON 結構（<a href=https://github.com/twitter/typeahead.js/#datum>Datum</a>），以做到更精細的控制或呈現。</p><p>詳細文件可以參考</p><ul><li>官網 <a href=https://github.com/twitter/typeahead.js/>https://github.com/twitter/typeahead.js/</a></li><li>官方範例 <a href=http://twitter.github.io/typeahead.js/examples/>http://twitter.github.io/typeahead.js/examples/</a></li></ul></div><div class=article-toc><h3>Contents</h3><nav id=TableOfContents></nav></div><footer class=article-footer><ul class=article-tag-list><li class=article-tag-list-item><a class=article-tag-list-link href=https://shivahuang.cocoazen.com/tags/javascript>javascript</a></li><li class=article-tag-list-item><a class=article-tag-list-link href=https://shivahuang.cocoazen.com/tags/web>Web</a></li><li class=article-tag-list-item><a class=article-tag-list-link href=https://shivahuang.cocoazen.com/tags/frontend>frontend</a></li></ul></footer></div><nav id=article-nav><a href=../../posts/2013-11-22-sql-formatter/ id=article-nav-newer class=article-nav-link-wrap><div class=article-nav-title><span>&lt;</span>&nbsp;
SQL formatter</div></a><a href=../../posts/2013-08-19-redmine-email-configuration-of-deployment-on-heroku/ id=article-nav-older class=article-nav-link-wrap><div class=article-nav-title>在Heroku上部署Redmine時的email設定方式&nbsp;<span>></span></div></a></nav></article><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//shivahuangtalks.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section><footer id=footer><div class=outer><div id=footer-info class=inner>&copy; 2023 Shiva Huang Talks<br>Powered by <a href=https://gohugo.io target=_blank>Hugo</a> with theme <a href=https://github.com/carsonip/hugo-theme-minos target=_blank>Minos</a></div></div><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/tomorrow-night.min.css integrity="sha256-2wL88NKUqvJi/ExflDzkzUumjUM73mcK2gBvBBeLvTk=" crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin=anonymous></script>
<script>hljs.initHighlightingOnLoad()</script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css integrity=sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0 crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js integrity=sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1 crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js integrity="sha256-ExtbCSBuYA7kq1Pz362ibde9nnsHYPt6JxuxYeZbU+c=" crossorigin=anonymous></script>
<script>renderMathInElement(document.body)</script><script>document.getElementById("main-nav-toggle").addEventListener("click",function(){var e=document.getElementById("header");e.classList.contains("mobile-on")?e.classList.remove("mobile-on"):e.classList.add("mobile-on")})</script></footer></div></body></html>